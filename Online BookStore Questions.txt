1. What are the details of all books purchased in the year 2022?

--> SELECT o.order_id, COUNT(oi.book_id) AS total_number_of_books,
       b.title, b.author, b.genre, b.price, SUM(b.price) AS total_cost
FROM orders o
JOIN order_items oi ON o.order_id = oi.order_id
JOIN books b ON oi.book_id = b.book_id
WHERE YEAR(o.order_date) = 2022
GROUP BY oi.book_id;

2. What is the total number of books sold by each customer?

--> SELECT c.customer_id, CONCAT(c.first_name, ' ', c.last_name) AS customer_name,
       COUNT(oi.book_id) AS number_of_books_purchased
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_items oi ON o.order_id = oi.order_id
GROUP BY c.customer_id;

3. What is the total revenue generated by each customer?

--> SELECT c.customer_id, CONCAT(c.first_name, ' ', c.last_name) AS customer_name,
       SUM(b.price) AS total_revenue
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_items oi ON o.order_id = oi.order_id
JOIN books b ON oi.book_id = b.book_id
GROUP BY c.customer_id;

4. What are the details of the books purchased by each customer?

--> SELECT c.customer_id, CONCAT(c.first_name, ' ', c.last_name) AS customer_name,
       oi.book_id, b.title, b.author, b.genre, b.price
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_items oi ON o.order_id = oi.order_id
JOIN books b ON oi.book_id = b.book_id;

5. What is the total revenue generated by each book genre?

--> SELECT b.genre, SUM(b.price) AS total_revenue
FROM books b
JOIN order_items oi ON b.book_id = oi.book_id
JOIN orders o ON oi.order_id = o.order_id
WHERE YEAR(o.order_date) = 2022
GROUP BY b.genre;

6. What are the details of the books purchased in the year 2021 by customer 'Jane Smith'?

--> SELECT c.customer_id, CONCAT(c.first_name, ' ', c.last_name) AS customer_name,
       oi.book_id, b.title, b.author, b.genre, b.price
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_items oi ON o.order_id = oi.order_id
JOIN books b ON oi.book_id = b.book_id
WHERE c.first_name = 'Jane' AND c.last_name = 'Smith' AND YEAR(o.order_date) = 2021;

7. What is the total revenue generated by the sales of books in the 'Fiction' genre?

--> SELECT b.genre, SUM(b.price) AS total_revenue
FROM books b
JOIN order_items oi ON b.book_id = oi.book_id
JOIN orders o ON oi.order_id = o.order_id
WHERE b.genre = 'Fiction'
GROUP BY b.genre;

8. What is the total revenue generated by the sales of books in the 'Mystery' genre in the year 2022?

--> SELECT b.genre, SUM(b.price) AS total_revenue
FROM books b
JOIN order_items oi ON b.book_id = oi.book_id
JOIN orders o ON oi.order_id = o.order_id
WHERE b.genre = 'Mystery' AND YEAR(o.order_date) = 2022
GROUP BY b.genre;

9. Who is the customer who purchased the most number of books in the year 2023?

--> SELECT c.customer_id, CONCAT(c.first_name, ' ', c.last_name) AS customer_name, 
       COUNT(oi.book_id) AS number_of_books_purchased
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_items oi ON o.order_id = oi.order_id
WHERE YEAR(o.order_date) = 2023
GROUP BY c.customer_id
ORDER BY COUNT(oi.book_id) DESC
LIMIT 1;

10. Who is the customer with the highest total spending in the year 2022?

--> SELECT c.customer_id, CONCAT(c.first_name, ' ', c.last_name) AS customer_name,
       SUM(b.price) AS total_spending
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_items oi ON o.order_id = oi.order_id
JOIN books b ON oi.book_id = b.book_id
WHERE YEAR(o.order_date) = 2022
GROUP BY c.customer_id
ORDER BY SUM(b.price) DESC
LIMIT 1;



